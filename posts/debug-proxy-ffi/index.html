<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light dark">
  
  
    
  
  <meta name="description" content="ramblings">

  <title>Hijacking Chrome&#x27;s Network Tab to Debug an Electron App</title>
  <link rel="icon" type="image/png" sizes="32x32" href="https://seg6.space/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://seg6.space/img/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://seg6.space/img/apple-touch-icon.png">
  
  <style>

  /* light mode colors */
  body {
    --primary-color: #5871a2;
    --primary-pale-color: #5871a233;
    --primary-decoration-color: #5871a210;
    --bg-color: #ffffff;
    --text-color: #2f3030;
    --text-pale-color: #767676;
    --text-decoration-color: #a9a9a9;
    --highlight-mark-color: #5f75b020;

    --callout-note-color: #5871a2;
    --callout-tip-color: #268556;
    --callout-important-color: #885fc9;
    --callout-warning-color: #ab6632;
    --callout-caution-color: #c64e4e;
  }

  /* dark mode colors */
  body.dark {
    --primary-color: #6f8fd1;
    --primary-pale-color: #6f8fd166;
    --primary-decoration-color: #6f8fd112;
    --bg-color: #1c1c1c;
    --text-color: #c1c1c1;
    --text-pale-color: #848484;
    --text-decoration-color: #5f5f5f;
    --highlight-mark-color: #8296cb3b;

    --callout-note-color: #6f8fd1;
    --callout-tip-color: #47976f;
    --callout-important-color: #9776cd;
    --callout-warning-color: #ad7a52;
    --callout-caution-color: #d06161;
  }

  /* typography */
  body {
    --main-font: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
    --code-font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
    --homepage-max-width: 768px;
    --main-max-width: 768px;
    --avatar-size: 60px;
    --font-size: 16px;
    --line-height: 1.75;
    --img-border-radius: 0px;
    --detail-border-radius: 0px;
    --dark-mode-img-brightness: 0.75;
    --dark-mode-chart-brightness: 0.75;
    --inline-code-border-radius: 2px;
    --inline-code-bg-color: var(--primary-decoration-color);
    --block-code-border-radius: 0px;
    --block-code-border-color: var(--primary-color);
    --detail-border-color: var(--primary-color);
  }

</style>

  <link rel="stylesheet" href="https://seg6.space/main.css">
  

<link id="hl" rel="stylesheet" type="text/css" href="/giallo-light.css" />



  <style>
  .prose iframe {
    width: 100%;
    aspect-ratio: 16 / 9;
    display: block;
    margin: 0 auto;
  }
</style>

</head>

<body class="post">
  
  <script>
    const theme = sessionStorage.getItem('theme');
    const match = window.matchMedia("(prefers-color-scheme: dark)").matches;
    if ((theme && theme == 'dark') || (!theme && match)) {
      document.body.classList.add('dark');
      const hl = document.querySelector('link#hl');
      if (hl) hl.href = 'https://seg6.space/giallo-dark.css';
    }
  </script>
  
  
<div id="wrapper">
  <div id="blank"></div>
  <aside>
    
    
    <nav>
      <ul>
        
        <li>
          <a class="h2" href="#flying-blind">Flying Blind</a>
          
        </li>
        
        <li>
          <a class="h2" href="#hijacking-the-network-tab">Hijacking the Network Tab</a>
          
        </li>
        
        <li>
          <a class="h2" href="#building-it">Building It</a>
          
          <ul>
            
            <li>
              <a class="h3" href="#debug-server">Debug Server</a>
            </li>
            
            <li>
              <a class="h3" href="#proxy-functions">Proxy Functions</a>
            </li>
            
            <li>
              <a class="h3" href="#streaming-callbacks-via-sse">Streaming Callbacks via SSE</a>
            </li>
            
            <li>
              <a class="h3" href="#putting-it-together">Putting It Together</a>
            </li>
            
          </ul>
          
        </li>
        
        <li>
          <a class="h2" href="#what-i-found">What I Found</a>
          
        </li>
        
      </ul>
    </nav>
    
    
    <button id="back-to-top" aria-label="back to top">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>

    </button>
    
  </aside>
  <main>
    
<header>
  <nav>
    <a id="back-link" href="https:&#x2F;&#x2F;seg6.space&#x2F;posts">← Back</a>
  </nav>
</header>


    <div>
      
      
      
      
      <div id="copy-cfg" style="display: none;" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
"></div>
      
      <article class="prose">
        <h1>Hijacking Chrome&#x27;s Network Tab to Debug an Electron App</h1>
        <div id="post-info">
          <div id="date">
            <span id="publish">Dec 26, 2025</span>
            </div>

          
        </div>

        
        

        

        <p>A while back I was working on a local-first productivity app. Think notes, files, AI chat, all running on your machine with no cloud required. The frontend was Svelte running in Electron, but the core of the app lived in a Rust backend compiled as a native Node module using Neon FFI. Storage, search, embeddings, AI inference. All Rust.</p>
<p>The architecture was straightforward: frontend calls JavaScript functions like <code>js__store_create_resource</code> or <code>js__ai_send_chat_message</code>, those calls cross the FFI boundary into Rust, Rust does its thing with SQLite and ML models and whatever else, and returns the result. Clean separation. Rust handles the heavy lifting, JavaScript handles the UI.</p>
<p>This was a fast-moving project. Early stage, small team, lots of experimentation. Features got added, APIs changed, entire subsystems got rewritten. The kind of environment where you're making decisions on the fly and figuring out the "right" way to do things later. Proper observability? Structured logging? Sure, that was on the roadmap. Somewhere there.</p>
<p>Then the app started hanging.</p>
<h1 id="flying-blind">Flying Blind<a class="zola-anchor" href="#flying-blind" aria-label="Anchor link for: flying-blind" style="visibility: hidden;"></a>
</h1>
<p>Not crashing. Just... freezing. The UI would lock up for 10, 20, sometimes 30+ seconds. No error messages, no crash reports. Just a stuck app and a user staring at a frozen screen wondering if they should force quit.</p>
<p>And I had no idea what was causing it.</p>
<p>Was it a database query? A file operation? Something in the AI pipeline? The Rust code had grown complex. Worker threads, async channels, SQLite queries, embedding models. Any of it could be the culprit.</p>
<p>Here's the thing about native FFI calls: they're invisible. When JavaScript calls a Rust function, from the browser's perspective, nothing happens. There's no network request. There's no entry in DevTools. The call just... disappears into native land and comes back whenever it feels like it.</p>
<p>I couldn't see what functions were being called. I couldn't see what arguments were passed. I couldn't see how long each call took. The entire Rust backend was a black box.</p>
<p>I could scatter <code>console.log</code> statements everywhere. I could add timestamps before and after every call. I could instrument the Rust code with tracing spans. But this was a fire that needed to be out <em>now</em>, not after spending a week setting up proper observability infrastructure.</p>
<p>So I wrote a hack.</p>
<h1 id="hijacking-the-network-tab">Hijacking the Network Tab<a class="zola-anchor" href="#hijacking-the-network-tab" aria-label="Anchor link for: hijacking-the-network-tab" style="visibility: hidden;"></a>
</h1>
<p>Chrome DevTools has a beautiful Network tab. It shows every HTTP request with timing, headers, payload, response. What if I could make my native calls show up there?</p>
<p>The plan:</p>
<ol>
<li>Spin up a local HTTP server in the Electron preload process</li>
<li>Wrap every native function with a proxy that makes an HTTP POST instead</li>
<li>The server receives the request, calls the <em>actual</em> native function, returns the result</li>
<li>Now every FFI call shows up in the Network tab</li>
</ol>
<p>For streaming callbacks (like AI chat responses that come in chunks), I'd use Server-Sent Events to pipe the data back.</p>
<h1 id="building-it">Building It<a class="zola-anchor" href="#building-it" aria-label="Anchor link for: building-it" style="visibility: hidden;"></a>
</h1>
<p>The app already had a clean initialization pattern. All native functions went through an <code>initSFFS</code> function that loaded the native module and wrapped the functions with a handle:</p>
<pre class="giallo z-code"><code data-lang="javascript"><span class="giallo-l"><span class="z-storage z-type">const</span><span class="z-variable z-other z-constant"> sffs</span><span class="z-keyword"> =</span><span class="z-entity z-name"> require</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">@deta/backend</span><span class="z-punctuation z-definition z-string">&#39;</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-storage z-type">let</span><span class="z-variable z-other"> handle</span><span class="z-keyword"> =</span><span class="z-variable z-other"> sffs</span><span>.</span><span class="z-entity z-name">js__backend_tunnel_init</span><span>(</span></span>
<span class="giallo-l"><span class="z-variable z-other">  rootPath</span><span>,</span><span class="z-variable z-other"> appPath</span><span>,</span><span class="z-variable z-other"> localAiMode</span><span>,</span><span class="z-variable z-other"> languageSetting</span><span>,</span></span>
<span class="giallo-l"><span class="z-variable z-other">  numWorkerThreads</span><span>,</span><span class="z-variable z-other"> numProcessorThreads</span><span>,</span></span>
<span class="giallo-l"><span class="z-variable z-other">  eventBusCallback</span></span>
<span class="giallo-l"><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-storage z-type">const</span><span class="z-entity z-name"> with_handle</span><span class="z-keyword"> =</span><span> (</span><span class="z-variable">fn</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> (</span><span class="z-keyword">...</span><span class="z-variable">args</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span class="z-entity z-name"> fn</span><span>(</span><span class="z-variable z-other">handle</span><span>,</span><span class="z-keyword"> ...</span><span class="z-variable z-other">args</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-comment">//</span><span class="z-comment"> Normal mode: direct FFI calls</span></span>
<span class="giallo-l"><span class="z-keyword">return</span><span> {</span></span>
<span class="giallo-l"><span>  js__store_search_resources</span><span>:</span><span class="z-entity z-name"> with_handle</span><span>(</span><span class="z-variable z-other">sffs</span><span>.</span><span class="z-variable z-other">js__store_search_resources</span><span>)</span><span>,</span></span>
<span class="giallo-l"><span>  js__ai_send_chat_message</span><span>:</span><span class="z-entity z-name"> with_handle</span><span>(</span><span class="z-variable z-other">sffs</span><span>.</span><span class="z-variable z-other">js__ai_send_chat_message</span><span>)</span><span>,</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-comment">  //</span><span class="z-comment"> ... etc</span></span>
<span class="giallo-l"><span>}</span></span></code></pre>
<p>I added a flag: <code>--enable-debug-proxy</code>. When set, instead of returning direct wrappers, I'd return HTTP proxy functions.</p>
<h2 id="debug-server">Debug Server<a class="zola-anchor" href="#debug-server" aria-label="Anchor link for: debug-server" style="visibility: hidden;"></a>
</h2>
<pre class="giallo z-code"><code data-lang="javascript"><span class="giallo-l"><span class="z-storage z-type">const</span><span class="z-entity z-name"> setupDebugServer</span><span class="z-keyword"> =</span><span> (</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">  server</span><span class="z-keyword"> =</span><span class="z-variable z-other"> http</span><span>.</span><span class="z-entity z-name">createServer</span><span>(</span><span>(</span><span class="z-variable">req</span><span>,</span><span class="z-variable"> res</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">    res</span><span>.</span><span class="z-entity z-name">setHeader</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">Access-Control-Allow-Origin</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">*</span><span class="z-punctuation z-definition z-string">&#39;</span><span>)</span></span>
<span class="giallo-l"><span class="z-variable z-other">    res</span><span>.</span><span class="z-entity z-name">setHeader</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">Access-Control-Allow-Methods</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">OPTIONS, POST, GET</span><span class="z-punctuation z-definition z-string">&#39;</span><span>)</span></span>
<span class="giallo-l"><span class="z-variable z-other">    res</span><span>.</span><span class="z-entity z-name">setHeader</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">Access-Control-Allow-Headers</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">Content-Type</span><span class="z-punctuation z-definition z-string">&#39;</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-keyword">    if</span><span> (</span><span class="z-variable z-other">req</span><span>.</span><span class="z-variable z-other">method</span><span class="z-keyword"> ===</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">OPTIONS</span><span class="z-punctuation z-definition z-string">&#39;</span><span>)</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">      res</span><span>.</span><span class="z-entity z-name">writeHead</span><span>(</span><span class="z-constant">204</span><span>)</span></span>
<span class="giallo-l"><span class="z-variable z-other">      res</span><span>.</span><span class="z-entity z-name">end</span><span>(</span><span>)</span></span>
<span class="giallo-l"><span class="z-keyword">      return</span></span>
<span class="giallo-l"><span>    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-storage z-type">    const</span><span> [</span><span class="z-variable z-other z-constant">_</span><span>,</span><span class="z-variable z-other z-constant"> fn</span><span>,</span><span class="z-variable z-other z-constant"> action</span><span>,</span><span class="z-variable z-other z-constant"> callId</span><span>]</span><span class="z-keyword"> =</span><span class="z-variable z-other"> req</span><span>.</span><span class="z-variable z-other">url</span><span>.</span><span class="z-entity z-name">split</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">/</span><span class="z-punctuation z-definition z-string">&#39;</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-keyword">    if</span><span> (</span><span class="z-variable z-other">req</span><span>.</span><span class="z-variable z-other">method</span><span class="z-keyword"> ===</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">GET</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-keyword"> &amp;&amp;</span><span class="z-variable z-other"> action</span><span class="z-keyword"> ===</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">stream</span><span class="z-punctuation z-definition z-string">&#39;</span><span>)</span><span> {</span></span>
<span class="giallo-l"><span class="z-entity z-name">      handleSSE</span><span>(</span><span class="z-variable z-other">res</span><span>,</span><span class="z-variable z-other"> callId</span><span>)</span></span>
<span class="giallo-l"><span>    }</span><span class="z-keyword"> else</span><span class="z-keyword"> if</span><span> (</span><span class="z-variable z-other">req</span><span>.</span><span class="z-variable z-other">method</span><span class="z-keyword"> ===</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">POST</span><span class="z-punctuation z-definition z-string">&#39;</span><span>)</span><span> {</span></span>
<span class="giallo-l"><span class="z-entity z-name">      handlePostRequest</span><span>(</span><span class="z-variable z-other">req</span><span>,</span><span class="z-variable z-other"> res</span><span>,</span><span class="z-variable z-other"> fn</span><span>)</span></span>
<span class="giallo-l"><span>    }</span><span class="z-keyword"> else</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">      res</span><span>.</span><span class="z-entity z-name">writeHead</span><span>(</span><span class="z-constant">404</span><span>)</span></span>
<span class="giallo-l"><span class="z-variable z-other">      res</span><span>.</span><span class="z-entity z-name">end</span><span>(</span><span>)</span></span>
<span class="giallo-l"><span>    }</span></span>
<span class="giallo-l"><span>  }</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-variable z-other">  server</span><span>.</span><span class="z-entity z-name">listen</span><span>(</span><span class="z-constant">0</span><span>,</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">localhost</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span><span> (</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">    console</span><span>.</span><span class="z-entity z-name">log</span><span>(</span><span class="z-punctuation z-definition z-string">`</span><span class="z-string">Debug server running on port </span><span class="z-string">${</span><span class="z-variable z-other">server</span><span class="z-string">.</span><span class="z-entity z-name">address</span><span class="z-string">(</span><span class="z-string">)</span><span class="z-string">.</span><span class="z-variable z-other">port</span><span class="z-string">}</span><span class="z-punctuation z-definition z-string">`</span><span>)</span></span>
<span class="giallo-l"><span>  }</span><span>)</span></span>
<span class="giallo-l"><span>}</span></span></code></pre>
<p>Nothing fancy. A basic HTTP server that routes POST requests to function calls and GET requests to SSE streams.</p>
<h2 id="proxy-functions">Proxy Functions<a class="zola-anchor" href="#proxy-functions" aria-label="Anchor link for: proxy-functions" style="visibility: hidden;"></a>
</h2>
<p>Instead of calling the native function directly, the proxy makes an HTTP request:</p>
<pre class="giallo z-code"><code data-lang="javascript"><span class="giallo-l"><span class="z-storage z-type">const</span><span class="z-entity z-name"> createProxyFunction</span><span class="z-keyword"> =</span><span> (</span><span class="z-variable">key</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-keyword">  return</span><span class="z-storage"> async</span><span> (</span><span class="z-keyword">...</span><span class="z-variable">args</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-storage z-type">    const</span><span class="z-variable z-other z-constant"> isChat</span><span class="z-keyword"> =</span><span class="z-variable z-other"> key</span><span class="z-keyword"> ===</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">js__ai_send_chat_message</span><span class="z-punctuation z-definition z-string">&#39;</span></span>
<span class="giallo-l"><span class="z-storage z-type">    const</span><span class="z-variable z-other z-constant"> callId</span><span class="z-keyword"> =</span><span class="z-variable z-other"> isChat</span><span class="z-keyword"> ?</span><span class="z-variable z-other"> Math</span><span>.</span><span class="z-entity z-name">random</span><span>(</span><span>)</span><span>.</span><span class="z-entity z-name">toString</span><span>(</span><span class="z-constant">36</span><span>)</span><span>.</span><span class="z-entity z-name">slice</span><span>(</span><span class="z-constant">2</span><span>,</span><span class="z-constant"> 11</span><span>)</span><span class="z-keyword"> :</span><span class="z-constant"> undefined</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-keyword">    if</span><span> (</span><span class="z-variable z-other">isChat</span><span>)</span><span> {</span></span>
<span class="giallo-l"><span class="z-entity z-name">      setupSSE</span><span>(</span><span class="z-variable z-other">key</span><span>,</span><span class="z-variable z-other"> callId</span><span>,</span><span class="z-variable z-other"> args</span><span>[</span><span class="z-constant">2</span><span>]</span><span>)</span><span class="z-punctuation z-definition z-comment"> //</span><span class="z-comment"> args[2] is the callback</span></span>
<span class="giallo-l"><span>    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-storage z-type">    const</span><span class="z-variable z-other z-constant"> response</span><span class="z-keyword"> =</span><span class="z-keyword"> await</span><span class="z-entity z-name"> fetch</span><span>(</span><span class="z-punctuation z-definition z-string">`</span><span class="z-string">http://localhost:</span><span class="z-string">${</span><span class="z-variable z-other">server</span><span class="z-string">.</span><span class="z-entity z-name">address</span><span class="z-string">(</span><span class="z-string">)</span><span class="z-string">.</span><span class="z-variable z-other">port</span><span class="z-string">}</span><span class="z-string">/</span><span class="z-string">${</span><span class="z-variable z-other">key</span><span class="z-string">}</span><span class="z-punctuation z-definition z-string">`</span><span>,</span><span> {</span></span>
<span class="giallo-l"><span>      method</span><span>:</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">POST</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>      headers</span><span>:</span><span> {</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">Content-Type</span><span class="z-punctuation z-definition z-string">&#39;</span><span>:</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">application/json</span><span class="z-punctuation z-definition z-string">&#39;</span><span> }</span><span>,</span></span>
<span class="giallo-l"><span>      body</span><span>:</span><span class="z-variable z-other z-constant"> JSON</span><span>.</span><span class="z-entity z-name">stringify</span><span>(</span><span>{</span><span class="z-variable z-other"> args</span><span>,</span><span class="z-variable z-other"> callId</span><span> }</span><span>)</span></span>
<span class="giallo-l"><span>    }</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-keyword">    if</span><span> (</span><span class="z-keyword">!</span><span class="z-variable z-other">response</span><span>.</span><span class="z-variable z-other">ok</span><span>)</span><span> {</span></span>
<span class="giallo-l"><span class="z-keyword">      throw</span><span class="z-keyword"> new</span><span class="z-entity z-name"> Error</span><span>(</span><span class="z-punctuation z-definition z-string">`</span><span class="z-string">HTTP error status: </span><span class="z-string">${</span><span class="z-variable z-other">response</span><span class="z-string">.</span><span class="z-variable z-other">status</span><span class="z-string">}</span><span class="z-punctuation z-definition z-string">`</span><span>)</span></span>
<span class="giallo-l"><span>    }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-keyword">    return</span><span class="z-variable z-other"> response</span><span>.</span><span class="z-entity z-name">json</span><span>(</span><span>)</span></span>
<span class="giallo-l"><span>  }</span></span>
<span class="giallo-l"><span>}</span></span></code></pre>
<p>The server receives this, calls the real native function, and returns the result:</p>
<pre class="giallo z-code"><code data-lang="javascript"><span class="giallo-l"><span class="z-storage z-type">const</span><span class="z-entity z-name"> handlePostRequest</span><span class="z-keyword"> =</span><span> (</span><span class="z-variable">req</span><span>,</span><span class="z-variable"> res</span><span>,</span><span class="z-variable"> fn</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-storage z-type">  let</span><span class="z-variable z-other"> body</span><span class="z-keyword"> =</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-punctuation z-definition z-string">&#39;</span></span>
<span class="giallo-l"><span class="z-variable z-other">  req</span><span>.</span><span class="z-entity z-name">on</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">data</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span><span> (</span><span class="z-variable">chunk</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">    body</span><span class="z-keyword"> +=</span><span class="z-variable z-other"> chunk</span><span>.</span><span class="z-entity z-name">toString</span><span>(</span><span>)</span></span>
<span class="giallo-l"><span>  }</span><span>)</span></span>
<span class="giallo-l"><span class="z-variable z-other">  req</span><span>.</span><span class="z-entity z-name">on</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">end</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span><span class="z-storage"> async</span><span> (</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-storage z-type">    const</span><span> {</span><span class="z-variable z-other z-constant"> args</span><span>,</span><span class="z-variable z-other z-constant"> callId</span><span> }</span><span class="z-keyword"> =</span><span class="z-variable z-other z-constant"> JSON</span><span>.</span><span class="z-entity z-name">parse</span><span>(</span><span class="z-variable z-other">body</span><span>)</span></span>
<span class="giallo-l"><span class="z-keyword">    try</span><span> {</span></span>
<span class="giallo-l"><span class="z-keyword">      if</span><span> (</span><span class="z-variable z-other">fn</span><span class="z-keyword"> ===</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">js__ai_send_chat_message</span><span class="z-punctuation z-definition z-string">&#39;</span><span>)</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">        args</span><span>[</span><span class="z-constant">2</span><span>]</span><span class="z-keyword"> =</span><span class="z-entity z-name"> createProxyCallback</span><span>(</span><span class="z-variable z-other">callId</span><span>)</span></span>
<span class="giallo-l"><span>      }</span></span>
<span class="giallo-l"><span class="z-storage z-type">      const</span><span class="z-variable z-other z-constant"> result</span><span class="z-keyword"> =</span><span class="z-keyword"> await</span><span class="z-variable z-other"> sffs</span><span>[</span><span class="z-variable z-other">fn</span><span>]</span><span>(</span><span class="z-variable z-other">handle</span><span>,</span><span class="z-keyword"> ...</span><span class="z-variable z-other">args</span><span>)</span></span>
<span class="giallo-l"><span class="z-variable z-other">      res</span><span>.</span><span class="z-entity z-name">writeHead</span><span>(</span><span class="z-constant">200</span><span>,</span><span> {</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">Content-Type</span><span class="z-punctuation z-definition z-string">&#39;</span><span>:</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">application/json</span><span class="z-punctuation z-definition z-string">&#39;</span><span> }</span><span>)</span></span>
<span class="giallo-l"><span class="z-variable z-other">      res</span><span>.</span><span class="z-entity z-name">end</span><span>(</span><span class="z-variable z-other z-constant">JSON</span><span>.</span><span class="z-entity z-name">stringify</span><span>(</span><span class="z-variable z-other">result</span><span>)</span><span>)</span></span>
<span class="giallo-l"><span>    }</span><span class="z-keyword"> catch</span><span> (</span><span class="z-variable z-other">error</span><span>)</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">      res</span><span>.</span><span class="z-entity z-name">writeHead</span><span>(</span><span class="z-constant">500</span><span>,</span><span> {</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">Content-Type</span><span class="z-punctuation z-definition z-string">&#39;</span><span>:</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">application/json</span><span class="z-punctuation z-definition z-string">&#39;</span><span> }</span><span>)</span></span>
<span class="giallo-l"><span class="z-variable z-other">      res</span><span>.</span><span class="z-entity z-name">end</span><span>(</span><span class="z-variable z-other z-constant">JSON</span><span>.</span><span class="z-entity z-name">stringify</span><span>(</span><span>{</span><span> error</span><span>:</span><span class="z-variable z-other"> error</span><span>.</span><span class="z-variable z-other">message</span><span> }</span><span>)</span><span>)</span></span>
<span class="giallo-l"><span>    }</span></span>
<span class="giallo-l"><span>  }</span><span>)</span></span>
<span class="giallo-l"><span>}</span></span></code></pre><h2 id="streaming-callbacks-via-sse">Streaming Callbacks via SSE<a class="zola-anchor" href="#streaming-callbacks-via-sse" aria-label="Anchor link for: streaming-callbacks-via-sse" style="visibility: hidden;"></a>
</h2>
<p>Some functions take callbacks. AI chat, for example, streams responses chunk by chunk. I couldn't just serialize a callback function over HTTP.</p>
<p>The solution: Server-Sent Events. Before making the POST request, the client opens an SSE connection. The server replaces the original callback with one that emits to the SSE stream:</p>
<pre class="giallo z-code"><code data-lang="javascript"><span class="giallo-l"><span class="z-storage z-type">const</span><span class="z-entity z-name"> handleSSE</span><span class="z-keyword"> =</span><span> (</span><span class="z-variable">res</span><span>,</span><span class="z-variable"> callId</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">  res</span><span>.</span><span class="z-entity z-name">writeHead</span><span>(</span><span class="z-constant">200</span><span>,</span><span> {</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-string">    &#39;</span><span class="z-string">Content-Type</span><span class="z-punctuation z-definition z-string">&#39;</span><span>:</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">text/event-stream</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-string">    &#39;</span><span class="z-string">Cache-Control</span><span class="z-punctuation z-definition z-string">&#39;</span><span>:</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">no-cache</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span></span>
<span class="giallo-l"><span>    Connection</span><span>:</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">keep-alive</span><span class="z-punctuation z-definition z-string">&#39;</span></span>
<span class="giallo-l"><span>  }</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-storage z-type">  const</span><span class="z-variable z-other z-constant"> emitter</span><span class="z-keyword"> =</span><span class="z-keyword"> new</span><span class="z-entity z-name"> EventEmitter</span><span>(</span><span>)</span></span>
<span class="giallo-l"><span class="z-variable z-other">  callbackEmitters</span><span>.</span><span class="z-entity z-name">set</span><span>(</span><span class="z-variable z-other">callId</span><span>,</span><span class="z-variable z-other"> emitter</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-variable z-other">  emitter</span><span>.</span><span class="z-entity z-name">on</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">data</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span><span> (</span><span class="z-variable">data</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">    res</span><span>.</span><span class="z-entity z-name">write</span><span>(</span><span class="z-punctuation z-definition z-string">`</span><span class="z-string">data: </span><span class="z-string">${</span><span class="z-variable z-other z-constant">JSON</span><span class="z-string">.</span><span class="z-entity z-name">stringify</span><span class="z-string">(</span><span class="z-variable z-other">data</span><span class="z-string">)</span><span class="z-string">}</span><span class="z-constant">\n</span><span class="z-constant">\n</span><span class="z-punctuation z-definition z-string">`</span><span>)</span></span>
<span class="giallo-l"><span>  }</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-variable z-other">  res</span><span>.</span><span class="z-entity z-name">on</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">close</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span><span> (</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">    callbackEmitters</span><span>.</span><span class="z-entity z-name">delete</span><span>(</span><span class="z-variable z-other">callId</span><span>)</span></span>
<span class="giallo-l"><span>  }</span><span>)</span></span>
<span class="giallo-l"><span>}</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-storage z-type">const</span><span class="z-entity z-name"> createProxyCallback</span><span class="z-keyword"> =</span><span> (</span><span class="z-variable">callId</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-keyword">  return</span><span> (</span><span class="z-variable">data</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-storage z-type">    const</span><span class="z-variable z-other z-constant"> emitter</span><span class="z-keyword"> =</span><span class="z-variable z-other"> callbackEmitters</span><span>.</span><span class="z-entity z-name">get</span><span>(</span><span class="z-variable z-other">callId</span><span>)</span></span>
<span class="giallo-l"><span class="z-keyword">    if</span><span> (</span><span class="z-variable z-other">emitter</span><span>)</span><span class="z-variable z-other"> emitter</span><span>.</span><span class="z-entity z-name">emit</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">data</span><span class="z-punctuation z-definition z-string">&#39;</span><span>,</span><span class="z-variable z-other"> data</span><span>)</span></span>
<span class="giallo-l"><span>  }</span></span>
<span class="giallo-l"><span>}</span></span></code></pre>
<p>On the client side, an EventSource listens for these events and calls the original callback:</p>
<pre class="giallo z-code"><code data-lang="javascript"><span class="giallo-l"><span class="z-storage z-type">const</span><span class="z-entity z-name"> setupSSE</span><span class="z-keyword"> =</span><span> (</span><span class="z-variable">key</span><span>,</span><span class="z-variable"> callId</span><span>,</span><span class="z-variable"> originalCallback</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-storage z-type">  const</span><span class="z-variable z-other z-constant"> eventSource</span><span class="z-keyword"> =</span><span class="z-keyword"> new</span><span class="z-entity z-name"> EventSource</span><span>(</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-string">    `</span><span class="z-string">http://localhost:</span><span class="z-string">${</span><span class="z-variable z-other">server</span><span class="z-string">.</span><span class="z-entity z-name">address</span><span class="z-string">(</span><span class="z-string">)</span><span class="z-string">.</span><span class="z-variable z-other">port</span><span class="z-string">}</span><span class="z-string">/</span><span class="z-string">${</span><span class="z-variable z-other">key</span><span class="z-string">}</span><span class="z-string">/stream/</span><span class="z-string">${</span><span class="z-variable z-other">callId</span><span class="z-string">}</span><span class="z-punctuation z-definition z-string">`</span></span>
<span class="giallo-l"><span>  )</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-variable z-other">  eventSource</span><span>.</span><span class="z-entity z-name">onmessage</span><span class="z-keyword"> =</span><span> (</span><span class="z-variable">event</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-storage z-type">    const</span><span class="z-variable z-other z-constant"> data</span><span class="z-keyword"> =</span><span class="z-variable z-other z-constant"> JSON</span><span>.</span><span class="z-entity z-name">parse</span><span>(</span><span class="z-variable z-other">event</span><span>.</span><span class="z-variable z-other">data</span><span>)</span></span>
<span class="giallo-l"><span class="z-entity z-name">    originalCallback</span><span>(</span><span class="z-variable z-other">data</span><span>)</span></span>
<span class="giallo-l"><span>  }</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-variable z-other">  eventSource</span><span>.</span><span class="z-entity z-name">onerror</span><span class="z-keyword"> =</span><span> (</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> {</span></span>
<span class="giallo-l"><span class="z-variable z-other">    eventSource</span><span>.</span><span class="z-entity z-name">close</span><span>(</span><span>)</span></span>
<span class="giallo-l"><span>  }</span></span>
<span class="giallo-l"><span>}</span></span></code></pre><h2 id="putting-it-together">Putting It Together<a class="zola-anchor" href="#putting-it-together" aria-label="Anchor link for: putting-it-together" style="visibility: hidden;"></a>
</h2>
<p>The initialization now branches based on the debug flag:</p>
<pre class="giallo z-code"><code data-lang="javascript"><span class="giallo-l"><span class="z-keyword">return</span><span> {</span></span>
<span class="giallo-l"><span class="z-keyword">  ...</span><span class="z-variable z-other">Object</span><span>.</span><span class="z-entity z-name">fromEntries</span><span>(</span></span>
<span class="giallo-l"><span class="z-variable z-other">    Object</span><span>.</span><span class="z-entity z-name">entries</span><span>(</span><span class="z-variable z-other">sffs</span><span>)</span></span>
<span class="giallo-l"><span>      .</span><span class="z-entity z-name">filter</span><span>(</span><span>(</span><span>[</span><span class="z-variable">key</span><span>,</span><span class="z-variable"> value</span><span>]</span><span>)</span><span class="z-storage z-type"> =&gt;</span></span>
<span class="giallo-l"><span class="z-keyword">        typeof</span><span class="z-variable z-other"> value</span><span class="z-keyword"> ===</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">function</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-keyword"> &amp;&amp;</span></span>
<span class="giallo-l"><span class="z-variable z-other">        key</span><span>.</span><span class="z-entity z-name">startsWith</span><span>(</span><span class="z-punctuation z-definition z-string">&#39;</span><span class="z-string">js__</span><span class="z-punctuation z-definition z-string">&#39;</span><span>)</span><span class="z-keyword"> &amp;&amp;</span></span>
<span class="giallo-l"><span class="z-variable z-other">        key</span><span class="z-keyword"> !==</span><span class="z-punctuation z-definition z-string"> &#39;</span><span class="z-string">js__backend_tunnel_init</span><span class="z-punctuation z-definition z-string">&#39;</span></span>
<span class="giallo-l"><span>      )</span></span>
<span class="giallo-l"><span>      .</span><span class="z-entity z-name">map</span><span>(</span><span>(</span><span>[</span><span class="z-variable">key</span><span>,</span><span class="z-variable"> value</span><span>]</span><span>)</span><span class="z-storage z-type"> =&gt;</span><span> [</span></span>
<span class="giallo-l"><span class="z-variable z-other">        key</span><span>,</span></span>
<span class="giallo-l"><span class="z-variable z-other z-constant">        ENABLE_DEBUG_PROXY</span><span class="z-keyword"> ?</span><span class="z-entity z-name"> createProxyFunction</span><span>(</span><span class="z-variable z-other">key</span><span>)</span><span class="z-keyword"> :</span><span class="z-entity z-name"> with_handle</span><span>(</span><span class="z-variable z-other">value</span><span>)</span></span>
<span class="giallo-l"><span>      ]</span><span>)</span></span>
<span class="giallo-l"><span>  )</span><span>,</span></span>
<span class="giallo-l"><span class="z-variable z-other">  js__backend_event_bus_register</span></span>
<span class="giallo-l"><span>}</span></span></code></pre>
<p>Same API surface. When debug proxy is off, direct FFI calls. When it's on, everything goes through HTTP.</p>
<h1 id="what-i-found">What I Found<a class="zola-anchor" href="#what-i-found" aria-label="Anchor link for: what-i-found" style="visibility: hidden;"></a>
</h1>
<p>With <code>--enable-debug-proxy</code>, I opened DevTools and watched my Network tab light up:</p>
<ul>
<li><code>POST /js__store_search_resources</code> - 847ms</li>
<li><code>POST /js__store_get_resource</code> - 12ms</li>
<li><code>POST /js__store_search_resources</code> - 23,847ms ← there's the problem</li>
</ul>
<p>I could see exactly which function was hanging, what arguments were passed, and how long each call took.</p>
<p>The 23-second search had a malformed query that was causing a full table scan. Found it in minutes, fixed it, moved on.</p>
<p><img src="/img/debug-proxy-ffi/network-tab.png" alt="Network tab showing FFI calls" /></p>
<p><img src="/img/debug-proxy-ffi/network-tab-payload.png" alt="Inspecting the payload" /></p>
<hr />
<p>Sometimes the right debugging tool is the one you build yourself in a moment of frustration. The hack stuck around and became a real feature and the rest of the team started using it too :)</p>

      </article>

      
      

      
      
    </div>

    


<footer>
  <div class="left">
    <div class="copyright">
      
      
    </div>
  </div>

  <div class="right">
    
    
      
    
    
    <a id="rss-btn" href="https://seg6.space/posts/rss.xml">RSS</a>
    
    

    
    
    
    <button id="theme-toggle" aria-label="theme switch">
      <span class="moon-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill="currentColor"></path></svg>
</span>
      <span class="sun-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" fill="currentColor"></path></svg>
</span>
    </button>
    
  </div>
</footer>




<dialog id="rss-mask">
  <div>
    <a href="https:&#x2F;&#x2F;seg6.space&#x2F;posts&#x2F;rss.xml">https:&#x2F;&#x2F;seg6.space&#x2F;posts&#x2F;rss.xml</a>
    
    
    <button autofocus aria-label="copy" data-link="https:&#x2F;&#x2F;seg6.space&#x2F;posts&#x2F;rss.xml" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>

    </button>
  </div>
</dialog>



  </main>
</div>

  
<script src="/js/lightense.min.js"></script>


  <script src="https://seg6.space/js/main.js"></script>
</body>

</html>
